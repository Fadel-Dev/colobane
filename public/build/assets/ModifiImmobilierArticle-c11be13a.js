import{g as te,r as V,d as I,M as se,c as oe,w as ie,o as r,b as le,u as l,X as ne,a as e,f as a,F as w,k,n as f,t as m,h as p,e as b,z as y,p as C,j as c,y as re,O as ae}from"./app-46413578.js";import{_ as de}from"./AppLayout-51d894ad.js";import"./_plugin-vue_export-helper-c27b6911.js";const ce={class:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50 py-8"},ue={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},pe=e("div",{class:"text-center mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Modifier votre annonce immobilière "),e("p",{class:"text-gray-600"}," Modifiez les informations de votre annonce ci-dessous ")],-1),ge={key:0,class:"mb-8"},me={class:"flex items-center justify-between"},be={class:"flex items-center flex-1"},he={key:0,class:"bi bi-check-lg text-xl"},fe={key:1},xe={key:1,class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6 mb-8"},_e=["onClick"],ve={class:"p-6 text-center"},ye={class:"text-lg font-semibold text-gray-800 group-hover:text-principal transition-colors duration-300"},we=["onSubmit"],ke={key:0,class:"space-y-6"},Se=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"}," Informations de base ")],-1),Ve=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Titre de l'annonce "),e("span",{class:"text-red-500"},"*")],-1),Ie=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Prix (FCFA) "),e("span",{class:"text-red-500"},"*")],-1),Ce=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Description "),e("span",{class:"text-red-500"},"*")],-1),je=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Région "),e("span",{class:"text-red-500"},"*")],-1),Ee=e("option",{value:"",disabled:"",selected:"",hidden:""},"Sélectionnez une région",-1),Ae=e("option",{value:"Dakar"},"Dakar",-1),De=e("option",{value:"Diourbel"},"Diourbel",-1),Le=e("option",{value:"Fatick"},"Fatick",-1),ze=e("option",{value:"Kaffrine"},"Kaffrine",-1),Oe=e("option",{value:"Kaolack"},"Kaolack",-1),Me=e("option",{value:"Kédougou"},"Kédougou",-1),Te=e("option",{value:"Kolda"},"Kolda",-1),qe=e("option",{value:"Louga"},"Louga",-1),Fe=e("option",{value:"Matam"},"Matam",-1),Ne=e("option",{value:"Saint-Louis"},"Saint-Louis",-1),$e=e("option",{value:"Sédhiou"},"Sédhiou",-1),Ke=e("option",{value:"Tambacounda"},"Tambacounda",-1),Ue=e("option",{value:"Thiès"},"Thiès",-1),We=e("option",{value:"Ziguinchor"},"Ziguinchor",-1),Re=[Ee,Ae,De,Le,ze,Oe,Me,Te,qe,Fe,Ne,$e,Ke,Ue,We],Be=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Catégorie "),e("span",{class:"text-red-500"},"*")],-1),Je=e("option",{value:"",disabled:"",selected:"",hidden:""},"Sélectionnez...",-1),Ge=e("option",{value:"Vente"},"Vente",-1),Ze=e("option",{value:"Location"},"Location",-1),Pe=[Je,Ge,Ze],Xe={class:"flex justify-end pt-4"},He=["disabled"],Qe=e("i",{class:"bi bi-arrow-right ml-2"},null,-1),Ye={key:1,class:"space-y-6"},et=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"}," Détails du bien ")],-1),tt={key:0},st=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Nombre de pièces "),e("span",{class:"text-red-500"},"*")],-1),ot={key:1},it=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Surface (m²) "),e("span",{class:"text-red-500"},"*")],-1),lt=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[c(" Type d'affaire "),e("span",{class:"text-red-500"},"*")],-1),nt=e("option",{value:"",disabled:"",selected:""},"Sélectionnez...",-1),rt=e("option",{value:"Vente"},"Vente",-1),at=e("option",{value:"Location"},"Location",-1),dt=[nt,rt,at],ct={class:"flex justify-between pt-4"},ut=e("i",{class:"bi bi-arrow-left mr-2"},null,-1),pt=["disabled"],gt=e("i",{class:"bi bi-arrow-right ml-2"},null,-1),mt={key:2,class:"space-y-6"},bt=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"}," Photos du bien ")],-1),ht={key:0,class:"mb-6"},ft=e("h3",{class:"text-lg font-semibold text-gray-700 mb-4"},"Images actuelles",-1),xt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},_t=["src","alt"],vt=["onClick"],yt=e("i",{class:"bi bi-x-lg text-sm"},null,-1),wt=[yt],kt=e("div",{class:"absolute bottom-2 left-2 bg-black/60 text-white px-2 py-1 rounded text-xs font-semibold"}," Actuelle ",-1),St=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"}," Ajouter de nouvelles photos ",-1),Vt={class:"text-xs text-gray-500 mb-4"},It={key:0,class:"text-principal font-semibold"},Ct={class:"mb-6"},jt=e("i",{class:"bi bi-cloud-upload text-5xl text-principal mb-3"},null,-1),Et=e("p",{class:"text-lg font-semibold text-gray-900 mb-1"}," Cliquez pour sélectionner des photos ",-1),At=e("p",{class:"text-sm text-gray-600"}," ou glissez-déposez vos images ici ",-1),Dt={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Lt=["src","alt"],zt=["onClick"],Ot=e("i",{class:"bi bi-x-lg text-sm"},null,-1),Mt=[Ot],Tt={class:"absolute bottom-2 left-2 bg-principal text-white px-2 py-1 rounded text-xs font-semibold"},qt={class:"flex justify-between pt-4"},Ft=e("i",{class:"bi bi-arrow-left mr-2"},null,-1),Nt=["disabled"],$t={key:0,class:"bi bi-check-lg ml-2"},Kt={key:1,class:"bi bi-hourglass-split animate-spin ml-2"},Bt={__name:"ModifiImmobilierArticle",props:{maison:Object,nameSeler:Object,mailSeler:Object,phoneSeler:Object,urlActuelle:Object},setup(B){var M,T,q,F,N,$,K,U,W;const n=B,s=te({nom:((M=n.maison)==null?void 0:M.nom)||"",description:((T=n.maison)==null?void 0:T.description)||"",prix:((q=n.maison)==null?void 0:q.prix)||"",type:((F=n.maison)==null?void 0:F.type)||"",npiece:((N=n.maison)==null?void 0:N.npiece)||"",surface:(($=n.maison)==null?void 0:$.surface)||"",region:((K=n.maison)==null?void 0:K.region)||"",categorie:((U=n.maison)==null?void 0:U.categorie)||"",affaire:((W=n.maison)==null?void 0:W.affaire)||"",images:[],image1:null,image2:null,image3:null,deletedImages:[]}),u=V([]),v=10,x=V([]),j=I(()=>{var o,d,_,R;const t=[];(o=n.maison)!=null&&o.image1&&n.maison.image1!==""&&!x.value.includes(n.maison.image1)&&t.push({url:n.maison.image1,id:"image1",isExisting:!0}),(d=n.maison)!=null&&d.image2&&n.maison.image2!==""&&!x.value.includes(n.maison.image2)&&t.push({url:n.maison.image2,id:"image2",isExisting:!0}),(_=n.maison)!=null&&_.image3&&n.maison.image3!==""&&!x.value.includes(n.maison.image3)&&t.push({url:n.maison.image3,id:"image3",isExisting:!0});let i=[];if((R=n.maison)!=null&&R.images){if(Array.isArray(n.maison.images))i=n.maison.images;else if(typeof n.maison.images=="string")try{i=JSON.parse(n.maison.images)}catch(h){console.error("Erreur parsing JSON images:",h),i=[]}}return Array.isArray(i)&&i.forEach((h,Y)=>{h&&h!==""&&!t.some(ee=>ee.url===h)&&!x.value.includes(h)&&t.push({url:h,id:`json_${Y}`,isExisting:!0})}),t}),J=t=>!t||t==="null"||t===""?"https://via.placeholder.com/800x600?text=Image+non+disponible":t.startsWith("http://")||t.startsWith("https://")?t:t.startsWith("storage/")||t.startsWith("/storage/")?t.startsWith("/")?t:"/"+t:"/storage/"+t;function G(t){const i=Array.from(t.target.files);E(i),t.target&&(t.target.value="")}function E(t){const i=v-u.value.length;t.slice(0,i).forEach(d=>{if(d.type.startsWith("image/")){const _=URL.createObjectURL(d);u.value.push({file:d,preview:_,id:Date.now()+Math.random(),isExisting:!1}),s.images.push(d)}})}function Z(t){t.preventDefault(),t.stopPropagation();const i=Array.from(t.dataTransfer.files);E(i)}function A(t){t.preventDefault(),t.stopPropagation()}function P(t){u.value[t].preview&&URL.revokeObjectURL(u.value[t].preview),u.value.splice(t,1),s.images.splice(t,1)}function X(t){x.value.includes(t)||x.value.push(t);let i=t;t.includes("/storage/")?i=t.split("/storage/")[1]||t:t.startsWith("storage/")&&(i=t.replace("storage/","")),!s.deletedImages.includes(i)&&!s.deletedImages.includes(t)&&(s.deletedImages.push(i),i!==t&&s.deletedImages.push(t))}const D=I(()=>s.nom&&s.prix&&s.description&&s.type),L=I(()=>["Villa","Appartement","Immeuble","Chambre"].includes(s.type)?s.npiece&&s.affaire:s.surface&&s.affaire),g=V(1),S=3;function z(){g.value<S&&g.value++}function O(){g.value>1&&g.value--}function H(){s.images.length>0&&(s.image1=s.images[0]||null,s.image2=s.images.length>1?s.images[1]:null,s.image3=s.images.length>2?s.images[2]:null),s.put(`/immobilier/${n.maison.id}`,{preserveScroll:!0,onSuccess:()=>{ae.visit("/dashboard")}})}se(()=>{u.value.forEach(t=>{t.preview&&!t.isExisting&&URL.revokeObjectURL(t.preview)})});const Q=[{id:1,titre:"Villa",icon:"bi-house-door"},{id:2,titre:"Appartement",icon:"bi-building"},{id:3,titre:"Terrain",icon:"bi-map"},{id:4,titre:"Chambre",icon:"bi-door-open"},{id:5,titre:"Immeuble",icon:"bi-buildings"},{id:6,titre:"Verger",icon:"bi-tree"},{id:7,titre:"Ferme",icon:"bi-barn"}];return(t,i)=>(r(),oe(de,{title:"Modifier l'annonce"},{default:ie(()=>[le(l(ne),{title:"Modifier l'annonce immobilière"}),e("div",ce,[e("div",ue,[pe,l(s).type?(r(),a("div",ge,[e("div",me,[(r(),a(w,null,k(S,o=>e("div",{key:o,class:"flex items-center flex-1"},[e("div",be,[e("div",{class:f(["w-10 h-10 rounded-full flex items-center justify-center font-bold transition-all",g.value>=o?"bg-principal text-white":"bg-gray-200 text-gray-500"])},[g.value>o?(r(),a("i",he)):(r(),a("span",fe,m(o),1))],2),o<S?(r(),a("div",{key:0,class:f(["flex-1 h-1 mx-2 rounded-full transition-all",g.value>o?"bg-principal":"bg-gray-200"])},null,2)):p("",!0)])])),64))])])):p("",!0),l(s).type?p("",!0):(r(),a("div",xe,[(r(),a(w,null,k(Q,o=>e("div",{key:o.id,onClick:d=>l(s).type=o.titre,class:f(["relative bg-white rounded-2xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 cursor-pointer group",l(s).type===o.titre?"ring-4 ring-principal ring-opacity-60":""])},[e("div",ve,[e("i",{class:f(`bi ${o.icon} text-5xl text-principal mb-4 group-hover:scale-110 transition-transform duration-300`)},null,2),e("h3",ye,m(o.titre),1)])],10,_e)),64))])),l(s).type?(r(),a("form",{key:2,onSubmit:re(H,["prevent"]),class:"bg-white p-8 rounded-2xl shadow-xl"},[g.value===1?(r(),a("div",ke,[Se,e("div",null,[Ve,b(e("input",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all",id:"nom",name:"nom",type:"text",placeholder:"Ex: Belle villa avec piscine","onUpdate:modelValue":i[0]||(i[0]=o=>l(s).nom=o),required:""},null,512),[[y,l(s).nom]])]),e("div",null,[Ie,b(e("input",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all",id:"prix",type:"text",placeholder:"Ex: 50000000",name:"prix","onUpdate:modelValue":i[1]||(i[1]=o=>l(s).prix=o),required:""},null,512),[[y,l(s).prix]])]),e("div",null,[Ce,b(e("textarea",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all",id:"description",rows:"5",name:"description","onUpdate:modelValue":i[2]||(i[2]=o=>l(s).description=o),placeholder:"Décrivez votre bien en détail...",required:""},null,512),[[y,l(s).description]])]),e("div",null,[je,b(e("select",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all bg-white","onUpdate:modelValue":i[3]||(i[3]=o=>l(s).region=o),required:""},Re,512),[[C,l(s).region]])]),e("div",null,[Be,b(e("select",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all bg-white","onUpdate:modelValue":i[4]||(i[4]=o=>l(s).categorie=o),required:""},Pe,512),[[C,l(s).categorie]])]),e("div",Xe,[e("button",{type:"button",onClick:z,disabled:!l(D),class:f(["px-6 py-3 rounded-xl font-semibold transition-all",l(D)?"bg-principal text-white hover:bg-principal-dark shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"])},[c(" Suivant "),Qe],10,He)])])):p("",!0),g.value===2?(r(),a("div",Ye,[et,["Villa","Appartement","Immeuble","Chambre"].includes(l(s).type)?(r(),a("div",tt,[st,b(e("input",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all",id:"npiece",name:"npiece",type:"text",placeholder:"Ex: 4","onUpdate:modelValue":i[5]||(i[5]=o=>l(s).npiece=o),required:""},null,512),[[y,l(s).npiece]])])):(r(),a("div",ot,[it,b(e("input",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all",id:"surface",name:"surface",type:"text",placeholder:"Ex: 500","onUpdate:modelValue":i[6]||(i[6]=o=>l(s).surface=o),required:""},null,512),[[y,l(s).surface]])])),e("div",null,[lt,b(e("select",{class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-principal focus:border-transparent transition-all bg-white",id:"affaire",name:"affaire","onUpdate:modelValue":i[7]||(i[7]=o=>l(s).affaire=o),required:""},dt,512),[[C,l(s).affaire]])]),e("div",ct,[e("button",{type:"button",onClick:O,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all"},[ut,c(" Précédent ")]),e("button",{type:"button",onClick:z,disabled:!l(L),class:f(["px-6 py-3 rounded-xl font-semibold transition-all",l(L)?"bg-principal text-white hover:bg-principal-dark shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"])},[c(" Suivant "),gt],10,pt)])])):p("",!0),g.value===3?(r(),a("div",mt,[bt,l(j).length>0?(r(),a("div",ht,[ft,e("div",xt,[(r(!0),a(w,null,k(l(j),(o,d)=>(r(),a("div",{key:o.id,class:"relative group aspect-square rounded-xl overflow-hidden shadow-md border border-gray-200"},[e("img",{src:J(o.url),alt:`Image ${d+1}`,class:"w-full h-full object-cover"},null,8,_t),e("button",{type:"button",onClick:_=>X(o.url),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100 z-10","aria-label":"Supprimer l'image"},wt,8,vt),kt]))),128))])])):p("",!0),e("div",null,[St,e("p",Vt,[c(" Sélectionnez plusieurs photos à la fois (maximum "+m(v)+" photos) "),u.value.length>0?(r(),a("span",It," - "+m(u.value.length)+"/"+m(v)+" sélectionnées ",1)):p("",!0)]),e("div",Ct,[u.value.length<v?(r(),a("label",{key:0,onDrop:Z,onDragover:A,onDragenter:A,class:"block w-full border-2 border-dashed border-principal rounded-xl cursor-pointer hover:bg-principal/5 transition-colors p-8 text-center"},[e("div",null,[jt,Et,At,e("p",{class:"text-xs text-gray-500 mt-2"}," Formats acceptés: JPG, PNG, WEBP (max "+m(v)+" photos) ")]),e("input",{type:"file",onChange:G,class:"hidden",accept:"image/*",multiple:""},null,32)],32)):p("",!0)]),u.value.length>0?(r(),a("div",Dt,[(r(!0),a(w,null,k(u.value,(o,d)=>(r(),a("div",{key:o.id,class:"relative group aspect-square rounded-xl overflow-hidden shadow-md border border-gray-200"},[e("img",{src:o.preview,alt:`Preview ${d+1}`,class:"w-full h-full object-cover"},null,8,Lt),e("button",{type:"button",onClick:_=>P(d),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100 z-10","aria-label":"Supprimer l'image"},Mt,8,zt),e("div",Tt," Nouvelle Photo "+m(d+1),1)]))),128))])):p("",!0)]),e("div",qt,[e("button",{type:"button",onClick:O,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all"},[Ft,c(" Précédent ")]),e("button",{type:"submit",disabled:l(s).processing,class:f(["px-6 py-3 rounded-xl font-semibold transition-all",l(s).processing?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-principal text-white hover:bg-principal-dark shadow-lg hover:shadow-xl"])},[c(m(l(s).processing?"Enregistrement...":"Enregistrer les modifications")+" ",1),l(s).processing?(r(),a("i",Kt)):(r(),a("i",$t))],10,Nt)])])):p("",!0)],40,we)):p("",!0)])])]),_:1}))}};export{Bt as default};
